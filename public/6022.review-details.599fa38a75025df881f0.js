"use strict";(self.webpackChunkmy_new_custom_application_project=self.webpackChunkmy_new_custom_application_project||[]).push([[6022],{"./src/components/review-details/review-details.tsx":(e,o,t)=>{t.r(o),t.d(o,{default:()=>T});var s=t("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/values.js"),n=t.n(s),l=t("./node_modules/react-intl/lib/src/components/useIntl.js"),a=t("./node_modules/react-router/esm/react-router.js"),i=t("./node_modules/@commercetools-frontend/application-components/dist/commercetools-frontend-application-components.esm.js"),r=t("./node_modules/@commercetools-uikit/notifications/dist/commercetools-uikit-notifications.esm.js"),d=t("./node_modules/@commercetools-uikit/text/dist/commercetools-uikit-text.esm.js"),c=t("./node_modules/@commercetools-uikit/spacings/dist/commercetools-uikit-spacings.esm.js"),m=t("./node_modules/@commercetools-uikit/loading-spinner/dist/commercetools-uikit-loading-spinner.esm.js"),u=t("./node_modules/react/index.js"),h=t("./node_modules/@commercetools-frontend/application-shell-connectors/dist/commercetools-frontend-application-shell-connectors.esm.js"),p=t("./node_modules/@commercetools-frontend/l10n/dist/commercetools-frontend-l10n.esm.js"),v=t("./node_modules/@commercetools-frontend/constants/dist/commercetools-frontend-constants.esm.js"),g=t("./node_modules/@commercetools-frontend/permissions/dist/commercetools-frontend-permissions.esm.js"),f=t("./node_modules/@commercetools-frontend/actions-global/dist/commercetools-frontend-actions-global.esm.js"),y=t("./src/constants.ts"),b=t("./src/hooks/use-reviews-connector/index.ts"),k=t("./node_modules/@commercetools-frontend/application-shell/dist/commercetools-frontend-application-shell.esm.js"),j=t("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js"),_=t.n(j),C=t("./node_modules/@babel/runtime-corejs3/core-js-stable/object/keys.js"),Z=t.n(C),E=t("./node_modules/formik/dist/formik.esm.js"),M=t("./node_modules/@commercetools-uikit/text-field/dist/commercetools-uikit-text-field.esm.js"),R=t("./node_modules/@commercetools-uikit/select-field/dist/commercetools-uikit-select-field.esm.js");const D={Pending:"Pending",Approved:"Approved"};var w=t("./node_modules/@babel/runtime-corejs3/core-js-stable/array/is-array.js"),L=t.n(w),x=t("./node_modules/@commercetools-uikit/text-input/dist/commercetools-uikit-text-input.esm.js"),B=t("./node_modules/omit-empty-es/dist/omit-empty-es.esm.js");const review_details_validate=e=>{const o={key:{},roles:{}};return x.Z.isEmpty(e.key)&&(o.key.missing=!0),L()(e.roles)&&0===e.roles.length&&(o.roles.missing=!0),(0,B.Z)(o)};const S=(0,t("./node_modules/react-intl/lib/index.js").vU)({backToChannelsList:{id:"ChannelDetails.backToChannelsList",defaultMessage:"Back to channels list"},duplicateKey:{id:"ChannelDetails.duplicateKey",defaultMessage:"A channel with this key already exists."},channelUpdated:{id:"ChannelDetails.channelUpdated",defaultMessage:"Review updated"},channelKeyLabel:{id:"ChannelDetails.channelKeyLabel",defaultMessage:"Review Key"},channelVersion:{id:"ChannelDetails.channelVersion",defaultMessage:"Review Version"},channelRatingLabel:{id:"ChannelDetails.channelRatingLabel",defaultMessage:"Review Rating"},channelNameLabel:{id:"ChannelDetails.channelNameLabel",defaultMessage:"Channel name"},channelRolesLabel:{id:"ChannelDetails.channelRolesLabel",defaultMessage:"Review State"},hint:{id:"ChannelDetails.hint",defaultMessage:"This page demonstrates for instance how to use forms, notifications and how to update data using GraphQL, etc."},modalTitle:{id:"ChannelDetails.modalTitle",defaultMessage:"Edit channel"},channelDetailsErrorMessage:{id:"ChannelDetails.errorMessage",defaultMessage:"We were unable to fetch the channel details. Please check your connection, the provided channel ID and try again."}});var F,K=t("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const O=_()(F=Z()(D)).call(F,(e=>({label:D[e],value:D[e]}))),ReviewDetailsForm=e=>{const o=(0,l.Z)(),t=(0,E.TA)({initialValues:e.initialValues,onSubmit:e.onSubmit,validate:review_details_validate,enableReinitialize:!0}),s=(0,K.BX)(c.Z.Stack,{scale:"l",children:[(0,K.tZ)(M.Z,{name:"key",title:o.formatMessage(S.channelKeyLabel),value:n()(t).key,errors:M.Z.toFieldErrors(t.errors).key,touched:t.touched.key,onBlur:t.handleBlur,isReadOnly:!0,renderError:e=>"duplicate"===e?o.formatMessage(S.duplicateKey):null,isRequired:!0,horizontalConstraint:13}),(0,K.tZ)(M.Z,{name:"version",title:o.formatMessage(S.channelVersion),value:n()(t).version,errors:M.Z.toFieldErrors(t.errors).version,touched:t.touched.version,onChange:t.handleChange,onBlur:t.handleBlur,isReadOnly:!0,renderError:e=>"duplicate"===e?o.formatMessage(S.duplicateKey):null,isRequired:!0,horizontalConstraint:13}),(0,K.tZ)(M.Z,{name:"rating",title:o.formatMessage(S.channelRatingLabel),value:n()(t).rating,errors:M.Z.toFieldErrors(t.errors).rating,touched:t.touched.rating,onChange:t.handleChange,onBlur:t.handleBlur,isReadOnly:!0,renderError:e=>"duplicate"===e?o.formatMessage(S.duplicateKey):null,horizontalConstraint:13}),(0,K.tZ)(R.Z,{name:"state",title:o.formatMessage(S.channelRolesLabel),value:n()(t).state,errors:R.Z.toFieldErrors(t.errors).state,touched:t.touched.state,onChange:t.handleChange,options:O,isReadOnly:e.isReadOnly,horizontalConstraint:13})]});return e.children({formElements:s,values:n()(t),isDirty:t.dirty,isSubmitting:t.isSubmitting,submitForm:t.handleSubmit,handleReset:t.handleReset})};ReviewDetailsForm.displayName="ReviewDetailsForm";const z=ReviewDetailsForm;var P=t("./node_modules/@commercetools-uikit/localized-text-input/dist/commercetools-uikit-localized-text-input.esm.js");const docToFormValues=(e,o)=>{var t,s,n,l,a;return{key:null!==(t=null===e||void 0===e?void 0:e.key)&&void 0!==t?t:"",rating:null===e||void 0===e?void 0:e.rating,state:null===e||void 0===e||null===(s=e.state)||void 0===s?void 0:s.key,version:null===e||void 0===e?void 0:e.version,name:P.Z.createLocalizedString(o,null!==(n=(0,p.sM)(null!==(l=null===e||void 0===e||null===(a=e.state)||void 0===a?void 0:a.nameAllLocales)&&void 0!==l?l:[]))&&void 0!==n?n:{})}};var V=t("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/reduce.js"),I=t.n(V);const ReviewDetails=e=>{const o=(0,l.Z)(),t=(0,a.UO)(),s=(0,b.Mx)(t.id),j=s.loading,_=s.error,C=s.review,Z=(0,h.UV)((e=>{var o,t,s;return{dataLocale:null!==(o=e.dataLocale)&&void 0!==o?o:"",projectLanguages:null!==(t=null===(s=e.project)||void 0===s?void 0:s.languages)&&void 0!==t?t:[]}})),E=Z.dataLocale,M=Z.projectLanguages,R=(0,g.bk)({demandedPermissions:[y._.Manage]}),D=(0,f.E0)(),w=(0,f._F)(),x=(0,b.fX)(),F=(0,u.useCallback)((async(e,t)=>{const s={key:(n=e).key,rating:n.rating,state:n.state,version:n.version};var n;try{await x.execute({originalDraft:C,nextDraft:s}),D({kind:"success",domain:v.w7.SIDE,text:o.formatMessage(S.channelUpdated,{channelName:(0,p.Wb)(e,{key:"name",locale:E,fallbackOrder:M})})})}catch(l){const e=(e=>{const o=L()(e)?e:[e],t=I()(o).call(o,((e,o)=>{var t,s,n,l;const a=null!==(t=null===o||void 0===o||null===(s=o.extensions)||void 0===s?void 0:s.code)&&void 0!==t?t:o.code,i=null!==(n=null===o||void 0===o||null===(l=o.extensions)||void 0===l?void 0:l.field)&&void 0!==n?n:o.field;return"DuplicateField"===a?e.formErrors[i]={duplicate:!0}:e.unmappedErrors.push(o),e}),{formErrors:{},unmappedErrors:[]}),s=t.formErrors,n=t.unmappedErrors;return{formErrors:(0,B.Z)(s),unmappedErrors:n}})(l);e.unmappedErrors.length>0&&w({errors:e.unmappedErrors}),t.setErrors(e.formErrors)}}),[C,x,E,o,M,w,D]);return(0,K.tZ)(z,{initialValues:docToFormValues(C,M),onSubmit:F,isReadOnly:!R,dataLocale:E,children:t=>{var s,l;return(0,K.BX)(i.ck,{title:null===(s=n()(t))||void 0===s?void 0:s.key,isOpen:!0,onClose:e.onClose,isPrimaryButtonDisabled:t.isSubmitting||!t.isDirty||!R,isSecondaryButtonDisabled:!t.isDirty,onSecondaryButtonClick:t.handleReset,onPrimaryButtonClick:()=>t.submitForm(),labelPrimaryButton:i.ck.Intl.save,labelSecondaryButton:i.ck.Intl.revert,children:[j&&(0,K.tZ)(c.Z.Stack,{alignItems:"center",children:(0,K.tZ)(m.Z,{})}),_&&(0,K.tZ)(r.I,{type:"error",children:(0,K.tZ)(d.Z.Body,{children:o.formatMessage(S.channelDetailsErrorMessage)})}),C&&t.formElements,C&&(0,K.tZ)(k.H4,{additionalParts:[null===(l=n()(t))||void 0===l?void 0:l.key]}),null===C&&(0,K.tZ)(i.uW,{})]})}})};ReviewDetails.displayName="ReviewDetails";const T=ReviewDetails},"./src/constants.ts":(e,o,t)=>{t.d(o,{_:()=>s});const s=(0,t("./node_modules/@commercetools-frontend/application-shell/ssr/dist/commercetools-frontend-application-shell-ssr.esm.js").X7)("product-review")}}]);
//# sourceMappingURL=6022.review-details.599fa38a75025df881f0.js.map